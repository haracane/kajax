require 'uri'
require 'net/http'

class UrlUtil
  
  def self.expand_url(url)
    real_url = nil
    begin
      uri = url.kind_of?(URI) ? url : URI.parse(url)
      http = Net::HTTP.new(uri.host, uri.port)
      http.read_timeout = 5
      http.start { |io|
        r = io.head(uri.path)
        status = r['Status']
        if status =~ /^[45]/ then
        else
          real_url = r['Location']
          if ! real_url then
            real_url = uri.to_s
          else
            if real_url !~ /^https?:\/\// then
              real_url = "#{uri.scheme}://#{uri.host}#{real_url}"
            end
          end
        end
      }
    rescue Exception=>e
      STDERR.puts e
      return nil
    end
    return real_url
  end
  
  def self.extract_url_from_text(text)
    ret = []
    if text then
      text.scan(/(https?:\/\/(([a-zA-Z0-9\-]+\.?)+)(\/[a-zA-Z0-9%=_\-\?\.]*)*)/) do |match|
        ret.push({:url=>match[0], :domain=>match[1]})
      end
    end
    return ret
  end
  
  def self.looks_like_redirect_url?(url)
    return false if 25 < url.length
    return url =~ /^https?:\/\/[a-zA-Z0-9\-]+\.[a-zA-Z0-9\-]+\/[a-zA-Z0-9%=_\-\?\.]+\/?$/
  end
  
  def self.is_redirect_domain?(domain)
    # '2jp.us', '3gk.me', '4sq.com', '7hit.tk', '919.li', 'a.r10.to', 'abf.to', 'amba.to', 'amzn.to', 'bit.ly', 'c23.biz', 'cnn.jp', 'deck.ly', 'deli-mahha.com', 'dff.jp', 'dlvr.it', 'easyurl.jp', 'ecolien.net', 'engt.co', 'exci.to', 'fb.me', 'fc2.in', 'ff.im', 'flic.kr', 'gbusc.net', 'gigaz.in', 'go.hpurl.net', 'goo.gl', 'ht.ly', 'htn.to', 'infobiz.2-d.jp', 'is.gd', 'isana.jp', 'j.mp', 'lb.to', 'lnk.ms', 'mb4sq.jp', 'mf1.jp', 'mixi.at', 'mns.jp', 'moby.to', 'moi.st', 'movook.com', 'mpr.hn', 'mysp.ac', 'nhk.jp', 'nico.ms', 'on.fb.me', 'os7.biz', 'osrsm.jp', 'ow.ly', 'p.tl', 'plixi.com', 'plurk.com', 'r10.to', 'rc9.jp', 'real.to', 's.mobion.jp', 's.nikkei.com', 'sek.ai', 'smatch.jp', 'snipurl.com', 't.asahi.com', 't.co', 'tdmm.jp', 'tiny.cc', 'tinyurl.com', 'tl.gd', 'tumblr.com', 'twitenna.jp', 'twme.jp', 'twrn.jp', 'twthpr.co', 'urx.nu', 'ustre.am', 'utun.jp', 'wcz.jp', 'wl.tl', 'wpp.jp', 'yj.pn', 'youtu.be'
    [ '2jp.us', '3gk.me', '4sq.com', '7hit.tk', '919.li', 'a.r10.to', 'abf.to', 'amba.to', 'amzn.to', 'bit.ly', 'c23.biz', 'cnn.jp', 'deck.ly', 'deli-mahha.com', 'dff.jp', 'dlvr.it', 'easyurl.jp', 'ecolien.net', 'engt.co', 'exci.to', 'fb.me', 'fc2.in', 'ff.im', 'flic.kr', 'gbusc.net', 'gigaz.in', 'go.hpurl.net', 'goo.gl', 'ht.ly', 'htn.to', 'infobiz.2-d.jp', 'is.gd', 'isana.jp', 'j.mp', 'lb.to', 'lnk.ms', 'mb4sq.jp', 'mf1.jp', 'mixi.at', 'mns.jp', 'moby.to', 'moi.st', 'movook.com', 'mpr.hn', 'mysp.ac', 'nhk.jp', 'nico.ms', 'on.fb.me', 'os7.biz', 'osrsm.jp', 'ow.ly', 'p.tl', 'plixi.com', 'plurk.com', 'r10.to', 'rc9.jp', 'real.to', 's.mobion.jp', 's.nikkei.com', 'sek.ai', 'smatch.jp', 'snipurl.com', 't.asahi.com', 't.co', 'tdmm.jp', 'tiny.cc', 'tinyurl.com', 'tl.gd', 'tumblr.com', 'twitenna.jp', 'twme.jp', 'twrn.jp', 'twthpr.co', 'urx.nu', 'ustre.am', 'utun.jp', 'wcz.jp', 'wl.tl', 'wpp.jp', 'yj.pn', 'youtu.be'
      ].include? domain
  end
  
  def self.is_real_domain?(domain)
    # '0120252082.jp', '0523246969.jp', '0taku.livedoor.biz', '123direct.info', '19va.info', '2ch.ja.utf8art.com', '2pondo.x.fc2.com', '3040.from.tv', '30thou.com', '311scale.jp', 'a1rvbyai.toypark.in', 'abcload.blog.fc2.com', 'ad2.h00.jp', 'adf.ly', 'adop.jp', 'ad-size.info', 'affiltwi.com', 'agito.shop-pro.jp', 'ajap.jp', 'akb.cx', 'akb48.grrr.jp', 'akb48.wp1.comuu.jp', 'akb48fc.afic.jp', 'alomaaloma.seesaa.net', 'amakake.com', 'ama-navi.com', 'ameblo.jp', 'anime.ja.utf8art.com', 'anond.hatelabo.jp', 'antiagiwei.com', 'asktweet.net', 'aspecta.otemo-yan.net', 'astore.amazon.co.jp', 'ateliana.jp', 'atmc.jp', 'auction.item.rakuten.co.jp', 'auction-auction.net', 'ayacnews2nd.com', 'a-yanke.jp', 'bbfactory.cart.fc2.com', 'bbs68.meiwasuisan.com', 'beeworksgames.com', 'bengoshi.com', 'bimimono.com', 'blip.fm', 'blog.esuteru.com', 'blog.goo.ne.jp', 'blog.livedoor.jp', 'blogkoza.ti-da.net', 'blogranking.fc2.com', 'blogs.yahoo.co.jp', 'boutbattle.seesaa.net', 'bsns-suc.blogspot.com', 'cabaret.irokoi.com', 'cashnet.web.fc2.com', 'ceron.jp', 'chaos2ch.com', 'chineroero.blog112.fc2.com', 'coco.to', 'com.nicovideo.jp', 'cookpad.com', 'credit-genkinka.com', 'cso.flets-w.com', 'd.hatena.ne.jp', 'dailygame.blog.fc2.com', 'dailynews.yahoo.co.jp', 'deai-cafe.jp', 'deaiintokyo.web.fc2.com', 'deai-legend.net', 'deaisentaku.web.fc2.com', 'deaitainya.com', 'deaitokyo.net', 'dedigaje.seesaa.net', 'dentweet.com', 'device-k.jp', 'dietweet.info', 'distweet.net', 'dolce-vip.com', 'dtwit.dip.jp', 'dw.sipo.jp', 'eee-shop.info', 'eighterhina.blog.shinobi.jp', 'eroqav.blog71.fc2.com', 'estar.jp', 'etcetera7.info', 'evatwi.com', 'expopi.net', 'f.hatena.ne.jp', 'farm4.static.flickr.com', 'feed.fkoji.com', 'flyff.gpotato.jp', 'fotolog.cc', 'fro.gy', 'fuckyeahyuuya.tumblr.com', 'funnys-bar.com', 'fupara.net', 'fuulog.jp', 'fx.e-shohyo.com', 'gadou.tv', 'gazouceleb.com', 'geinin2.jp', 'get.app4u.me', 'gift-tokyo.net', 'gigazine.net', 'girlfriends.x.fc2.com', 'gree.jp', 'gungho.jp', 'gw.tv', 'gwn.main.jp', 'hamusoku.com', 'hashtagsjp.appspot.com', 'hatsukari.2ch.net', 'headlines.yahoo.co.jp', 'hibipyorururu.web.fc2.com', 'hithot.cc', 'h-mbga.com', 'homepage3.nifty.com', 'hotelsg.com', 'hotkakogawa.com', 'ibihada.com', 'id.hanihoh.com', 'ie.to', 'iii.main.jp', 'ikuzi2.blog73.fc2.com', 'image.blog.livedoor.jp', 'image.news.livedoor.com', 'img.ly', 'img.pics.livedoor.com', 'imgcc.naver.jp', 'imgdisp.infocart.jp', 'infoedit.biz', 'instagr.am', 'ipodtouchlab.com', 'ippin-auction.com', 'item.rakuten.co.jp', 'itopix.jp', 'itunes.apple.com', 'japanese.engadget.com', 'joseinodeai.web.fc2.com', 'kanpai-m.jp', 'kasegeruauction.seesaa.net', 'keks.jp', 'kinshicho-fuzoku.jimdo.com', 'kiseki-net.org', 'koebu.com', 'kuchikomi.gnavi.co.jp', 'kuraberu.jp', 'kuu1.com', 'labaq.com', 'lexin.blog.so-net.ne.jp', 'like.jp', 'likeboard.me', 'lilysmile.exblog.jp', 'links-chat.sakura.ne.jp', 'live.nicovideo.jp', 'livedoor.2.blogimg.jp', 'lmr.cc', 'lockerz.com', 'logsoku.com', 'logtwit.com', 'luxlets.info', 'm.youtube.com', 'maps.google.co.jp', 'maps.google.com', 'marblee.tv', 'matome.naver.jp', 'mazomusume.jp', 'mcash.seesaa.net', 'meity.jp', 'michaelsan.livedoor.biz', 'mig21.jp', 'minnares.net', 'mipho.info', 'mituyubi.com', 'mixi.jp', 'mj-rising.jp', 'mlmseikou.sublimeblog.net', 'mogsnap.jp', 'motorsportworld.seesaa.net', 'movapic.com', 'movietwi.net', 'mukurolex.afic.jp', 'm-umeda.com', 'myloc.me', 'nailisthitomio.blog109.fc2.com', 'nakayoshi.hp2.jp', 'nanapi.jp', 'natalie.mu', 'nekojiman.com', 'netceleb.net', 'news4vip.livedoor.biz', 'news-check.com', 'newspapermap.com', 'nono-police.com', 'officej-glad.jp', 'oka-jp.seesaa.net', 'oketter.okwave.jp', 'ompookan.jp', 'orangered.sblo.jp', 'osaka.relax-rec.net', 'osouji-delivery.com', 'otokonohanasi.seesaa.net', 'oxkinaxwaxokinawa.ti-da.net', 'p.elne.jp', 'p.twimi.jp', 'p.twipple.jp', 'p.ybt.jp', 'paizuri2010.blog112.fc2.com', 'park.geocities.jp', 'photozou.jp', 'piapro.jp', 'pic.prcm.jp', 'pipli.jp', 'pjt.tv', 'plaza.rakuten.co.jp', 'plusd.itmedia.co.jp', 'pretty-kyoto.com', 'prev.twiuta.filmeee.com', 'prodigy-inc.co.jp', 'psnet.live-bb.lolipop.jp', 'px.a8.net', 'qa-now.com', 'q-pitter.net', 'qunqun.xtre.am', 'r.gnavi.co.jp', 'r.tabelog.com', 'renewsuga.com', 'repoblog.buttah.net', 'revinx.net', 'rmat.jp', 'ro69.jp', 'rsr.wess.co.jp', 'run.auone.jp', 'safecast.org', 'saikyoumama34.dousetsu.com', 'saikyoumama35.dousetsu.com', 'sake-marugen.com', 'sankei.jp.msn.com', 'shakariki.info', 'shindanmaker.com', 'shotaro-ai.jugem.jp', 'silvality.com', 'sm137.oiran.org', 'sns.prtls.jp', 'speedyspain.seesaa.net', 'store.shopping.yahoo.co.jp', 'suiseisekisuisui.blog107.fc2.com', 'sunperuka.blog27.fc2.com', 'syouhinnsetumei.blog.fc2.com', 'takinohyougu.jp', 'tamashii.jp', 'teegee440.jugem.jp', 'tenkomo.blog46.fc2.com', 'tera.hangame.co.jp', 'text.ssig33.com', 'thailabd.seesaa.net', 'togetter.com', 'tomedain.jp', 'tono158.blogspot.com', 'tou.ch', 'tower.jp', 'travel.web-special.jp', 'trendjp.net', 'trendoo.net', 'tsutaya.me', 'tubetw.it', 'tumblr.oooooz.com', 'tutal.blog.fc2.com', 'twiccha.com', 'twipla.jp', 'twitgoo.com', 'twitpic.com', 'twitter.com', 'twitterer-wiki.com', 'twitvideo.jp', 'twiuta.filmeee.com', 'twizard.net', 'ugrs-picbo.appspot.com', 'under15under.jugem.jp', 'uranow.org', 'web-plan.xtr.jp', 'wordpark.net', 'www.ac-ba.com', 'www.adultshop55.com', 'www.agentsaitama.co.jp', 'www.ai556.com', 'www.amare-osaka.com', 'www.amazon.co.jp', 'www.anihiro.net', 'www.aromamint.net', 'www.asuka-coffee.com', 'www.atrium-tokyo.com', 'www.banktime.jp', 'www.bekkoame.ne.jp', 'www.biscuitta.com', 'www.bz-vermillion.com', 'www.chatwalker.com', 'www.cityheaven.net', 'www.clover.sc', 'www.club-fin.com', 'www.club-infinity.jp', 'www.cmsite.co.jp', 'www.cosp.jp', 'www.cs-mts.jp', 'www.dericco.com', 'www.dmm.co.jp', 'www.dmm.com', 'www.dreamtribe.jp', 'www.d-tuma.com', 'www.ecs4.com', 'www.enecho.meti.go.jp', 'www.env.go.jp', 'www.facebook.com', 'www.falette.com', 'www.gamedesign.jp', 'www.gangan.bz', 'www.garbagenews.net', 'www.gekizou.biz', 'www.geocities.jp', 'www.gifu-aqua.com', 'www.girlsheaven-job.net', 'www.gizmodo.jp', 'www.goodsmile.info', 'www.herbal-underground.com', 'www.hokkaido-np.co.jp', 'www.honey-flash.biz', 'www.hotel-health.tv', 'www.hotemani.net', 'www.hotpepper.jp', 'www.hp-mitsumori.com', 'www.igomovie.net', 'www.ikoi151.com', 'www.ilmare-hair.net', 'www.importproducts.jp', 'www.itc-prodive.com', 'www.itmedia.co.jp', 'www.j-econo.com', 'www.jobnavi.bz', 'www.juk2.sakura.ne.jp', 'www.kanejarashi.com', 'www.kimono-bonkura.com', 'www.kk1919.net', 'www.kongbonaiti.com', 'www.kshel.com', 'www.kumanokonavi.com', 'www.last.fm', 'www.lastfm.jp', 'www.littlemode.jp', 'www.love-oku.jp', 'www.machioku-nanba.net', 'www.mizuhobank.co.jp', 'www.mizunoballpark.com', 'www.moon-light.biz', 'www.motionlink.jp', 'www.movatwi.jp', 'www.movatwitter.jp', 'www.m-standard.co.jp', 'www.muki-umeda.com', 'www.ncvb.or.jp', 'www.nicovideo.jp', 'www.oct-net.ne.jp', 'www.okusama-daigaku.com', 'www.pixiv.net', 'www.prime-kobe.net', 'www.rakuten.co.jp', 'www.rarejob.com', 'www.recycle-osaka.jp', 'www.s16.jp', 'www.saveon.co.jp', 'www.speed-speed.com', 'www.stickam.jp', 'www.sucre-osaka.com', 'www.sumitomo-rd-mansionblog.jp', 'www.takeuchi-studio.jp', 'www.themanzai.com', 'www.tnm-erotic.com', 'www.tokuma.co.jp', 'www.transit-web.com', 'www.trendjp.net', 'www.ustream.tv', 'www.yomiuri.co.jp', 'www.youtube.com', 'www3.hp-ez.com', 'www5b.biglobe.ne.jp', 'x14.peps.jp', 'x59.peps.jp', 'xv-s.heteml.jp', 'yaplog.jp', 'yaraon.blog109.fc2.com', 'yfrog.com', 'yiyine.info', 'z.twipple.jp', 'zasshi.news.yahoo.co.jp', 'zozo.jp', 'z-x.in'
    [ '0120252082.jp', '0523246969.jp', '0taku.livedoor.biz', '123direct.info', '19va.info', '2ch.ja.utf8art.com', '2pondo.x.fc2.com', '3040.from.tv', '30thou.com', '311scale.jp', 'a1rvbyai.toypark.in', 'abcload.blog.fc2.com', 'ad2.h00.jp', 'adf.ly', 'adop.jp', 'ad-size.info', 'affiltwi.com', 'agito.shop-pro.jp', 'ajap.jp', 'akb.cx', 'akb48.grrr.jp', 'akb48.wp1.comuu.jp', 'akb48fc.afic.jp', 'alomaaloma.seesaa.net', 'amakake.com', 'ama-navi.com', 'ameblo.jp', 'anime.ja.utf8art.com', 'anond.hatelabo.jp', 'antiagiwei.com', 'asktweet.net', 'aspecta.otemo-yan.net', 'astore.amazon.co.jp', 'ateliana.jp', 'atmc.jp', 'auction.item.rakuten.co.jp', 'auction-auction.net', 'ayacnews2nd.com', 'a-yanke.jp', 'bbfactory.cart.fc2.com', 'bbs68.meiwasuisan.com', 'beeworksgames.com', 'bengoshi.com', 'bimimono.com', 'blip.fm', 'blog.esuteru.com', 'blog.goo.ne.jp', 'blog.livedoor.jp', 'blogkoza.ti-da.net', 'blogranking.fc2.com', 'blogs.yahoo.co.jp', 'boutbattle.seesaa.net', 'bsns-suc.blogspot.com', 'cabaret.irokoi.com', 'cashnet.web.fc2.com', 'ceron.jp', 'chaos2ch.com', 'chineroero.blog112.fc2.com', 'coco.to', 'com.nicovideo.jp', 'cookpad.com', 'credit-genkinka.com', 'cso.flets-w.com', 'd.hatena.ne.jp', 'dailygame.blog.fc2.com', 'dailynews.yahoo.co.jp', 'deai-cafe.jp', 'deaiintokyo.web.fc2.com', 'deai-legend.net', 'deaisentaku.web.fc2.com', 'deaitainya.com', 'deaitokyo.net', 'dedigaje.seesaa.net', 'dentweet.com', 'device-k.jp', 'dietweet.info', 'distweet.net', 'dolce-vip.com', 'dtwit.dip.jp', 'dw.sipo.jp', 'eee-shop.info', 'eighterhina.blog.shinobi.jp', 'eroqav.blog71.fc2.com', 'estar.jp', 'etcetera7.info', 'evatwi.com', 'expopi.net', 'f.hatena.ne.jp', 'farm4.static.flickr.com', 'feed.fkoji.com', 'flyff.gpotato.jp', 'fotolog.cc', 'fro.gy', 'fuckyeahyuuya.tumblr.com', 'funnys-bar.com', 'fupara.net', 'fuulog.jp', 'fx.e-shohyo.com', 'gadou.tv', 'gazouceleb.com', 'geinin2.jp', 'get.app4u.me', 'gift-tokyo.net', 'gigazine.net', 'girlfriends.x.fc2.com', 'gree.jp', 'gungho.jp', 'gw.tv', 'gwn.main.jp', 'hamusoku.com', 'hashtagsjp.appspot.com', 'hatsukari.2ch.net', 'headlines.yahoo.co.jp', 'hibipyorururu.web.fc2.com', 'hithot.cc', 'h-mbga.com', 'homepage3.nifty.com', 'hotelsg.com', 'hotkakogawa.com', 'ibihada.com', 'id.hanihoh.com', 'ie.to', 'iii.main.jp', 'ikuzi2.blog73.fc2.com', 'image.blog.livedoor.jp', 'image.news.livedoor.com', 'img.ly', 'img.pics.livedoor.com', 'imgcc.naver.jp', 'imgdisp.infocart.jp', 'infoedit.biz', 'instagr.am', 'ipodtouchlab.com', 'ippin-auction.com', 'item.rakuten.co.jp', 'itopix.jp', 'itunes.apple.com', 'japanese.engadget.com', 'joseinodeai.web.fc2.com', 'kanpai-m.jp', 'kasegeruauction.seesaa.net', 'keks.jp', 'kinshicho-fuzoku.jimdo.com', 'kiseki-net.org', 'koebu.com', 'kuchikomi.gnavi.co.jp', 'kuraberu.jp', 'kuu1.com', 'labaq.com', 'lexin.blog.so-net.ne.jp', 'like.jp', 'likeboard.me', 'lilysmile.exblog.jp', 'links-chat.sakura.ne.jp', 'live.nicovideo.jp', 'livedoor.2.blogimg.jp', 'lmr.cc', 'lockerz.com', 'logsoku.com', 'logtwit.com', 'luxlets.info', 'm.youtube.com', 'maps.google.co.jp', 'maps.google.com', 'marblee.tv', 'matome.naver.jp', 'mazomusume.jp', 'mcash.seesaa.net', 'meity.jp', 'michaelsan.livedoor.biz', 'mig21.jp', 'minnares.net', 'mipho.info', 'mituyubi.com', 'mixi.jp', 'mj-rising.jp', 'mlmseikou.sublimeblog.net', 'mogsnap.jp', 'motorsportworld.seesaa.net', 'movapic.com', 'movietwi.net', 'mukurolex.afic.jp', 'm-umeda.com', 'myloc.me', 'nailisthitomio.blog109.fc2.com', 'nakayoshi.hp2.jp', 'nanapi.jp', 'natalie.mu', 'nekojiman.com', 'netceleb.net', 'news4vip.livedoor.biz', 'news-check.com', 'newspapermap.com', 'nono-police.com', 'officej-glad.jp', 'oka-jp.seesaa.net', 'oketter.okwave.jp', 'ompookan.jp', 'orangered.sblo.jp', 'osaka.relax-rec.net', 'osouji-delivery.com', 'otokonohanasi.seesaa.net', 'oxkinaxwaxokinawa.ti-da.net', 'p.elne.jp', 'p.twimi.jp', 'p.twipple.jp', 'p.ybt.jp', 'paizuri2010.blog112.fc2.com', 'park.geocities.jp', 'photozou.jp', 'piapro.jp', 'pic.prcm.jp', 'pipli.jp', 'pjt.tv', 'plaza.rakuten.co.jp', 'plusd.itmedia.co.jp', 'pretty-kyoto.com', 'prev.twiuta.filmeee.com', 'prodigy-inc.co.jp', 'psnet.live-bb.lolipop.jp', 'px.a8.net', 'qa-now.com', 'q-pitter.net', 'qunqun.xtre.am', 'r.gnavi.co.jp', 'r.tabelog.com', 'renewsuga.com', 'repoblog.buttah.net', 'revinx.net', 'rmat.jp', 'ro69.jp', 'rsr.wess.co.jp', 'run.auone.jp', 'safecast.org', 'saikyoumama34.dousetsu.com', 'saikyoumama35.dousetsu.com', 'sake-marugen.com', 'sankei.jp.msn.com', 'shakariki.info', 'shindanmaker.com', 'shotaro-ai.jugem.jp', 'silvality.com', 'sm137.oiran.org', 'sns.prtls.jp', 'speedyspain.seesaa.net', 'store.shopping.yahoo.co.jp', 'suiseisekisuisui.blog107.fc2.com', 'sunperuka.blog27.fc2.com', 'syouhinnsetumei.blog.fc2.com', 'takinohyougu.jp', 'tamashii.jp', 'teegee440.jugem.jp', 'tenkomo.blog46.fc2.com', 'tera.hangame.co.jp', 'text.ssig33.com', 'thailabd.seesaa.net', 'togetter.com', 'tomedain.jp', 'tono158.blogspot.com', 'tou.ch', 'tower.jp', 'travel.web-special.jp', 'trendjp.net', 'trendoo.net', 'tsutaya.me', 'tubetw.it', 'tumblr.oooooz.com', 'tutal.blog.fc2.com', 'twiccha.com', 'twipla.jp', 'twitgoo.com', 'twitpic.com', 'twitter.com', 'twitterer-wiki.com', 'twitvideo.jp', 'twiuta.filmeee.com', 'twizard.net', 'ugrs-picbo.appspot.com', 'under15under.jugem.jp', 'uranow.org', 'web-plan.xtr.jp', 'wordpark.net', 'www.ac-ba.com', 'www.adultshop55.com', 'www.agentsaitama.co.jp', 'www.ai556.com', 'www.amare-osaka.com', 'www.amazon.co.jp', 'www.anihiro.net', 'www.aromamint.net', 'www.asuka-coffee.com', 'www.atrium-tokyo.com', 'www.banktime.jp', 'www.bekkoame.ne.jp', 'www.biscuitta.com', 'www.bz-vermillion.com', 'www.chatwalker.com', 'www.cityheaven.net', 'www.clover.sc', 'www.club-fin.com', 'www.club-infinity.jp', 'www.cmsite.co.jp', 'www.cosp.jp', 'www.cs-mts.jp', 'www.dericco.com', 'www.dmm.co.jp', 'www.dmm.com', 'www.dreamtribe.jp', 'www.d-tuma.com', 'www.ecs4.com', 'www.enecho.meti.go.jp', 'www.env.go.jp', 'www.facebook.com', 'www.falette.com', 'www.gamedesign.jp', 'www.gangan.bz', 'www.garbagenews.net', 'www.gekizou.biz', 'www.geocities.jp', 'www.gifu-aqua.com', 'www.girlsheaven-job.net', 'www.gizmodo.jp', 'www.goodsmile.info', 'www.herbal-underground.com', 'www.hokkaido-np.co.jp', 'www.honey-flash.biz', 'www.hotel-health.tv', 'www.hotemani.net', 'www.hotpepper.jp', 'www.hp-mitsumori.com', 'www.igomovie.net', 'www.ikoi151.com', 'www.ilmare-hair.net', 'www.importproducts.jp', 'www.itc-prodive.com', 'www.itmedia.co.jp', 'www.j-econo.com', 'www.jobnavi.bz', 'www.juk2.sakura.ne.jp', 'www.kanejarashi.com', 'www.kimono-bonkura.com', 'www.kk1919.net', 'www.kongbonaiti.com', 'www.kshel.com', 'www.kumanokonavi.com', 'www.last.fm', 'www.lastfm.jp', 'www.littlemode.jp', 'www.love-oku.jp', 'www.machioku-nanba.net', 'www.mizuhobank.co.jp', 'www.mizunoballpark.com', 'www.moon-light.biz', 'www.motionlink.jp', 'www.movatwi.jp', 'www.movatwitter.jp', 'www.m-standard.co.jp', 'www.muki-umeda.com', 'www.ncvb.or.jp', 'www.nicovideo.jp', 'www.oct-net.ne.jp', 'www.okusama-daigaku.com', 'www.pixiv.net', 'www.prime-kobe.net', 'www.rakuten.co.jp', 'www.rarejob.com', 'www.recycle-osaka.jp', 'www.s16.jp', 'www.saveon.co.jp', 'www.speed-speed.com', 'www.stickam.jp', 'www.sucre-osaka.com', 'www.sumitomo-rd-mansionblog.jp', 'www.takeuchi-studio.jp', 'www.themanzai.com', 'www.tnm-erotic.com', 'www.tokuma.co.jp', 'www.transit-web.com', 'www.trendjp.net', 'www.ustream.tv', 'www.yomiuri.co.jp', 'www.youtube.com', 'www3.hp-ez.com', 'www5b.biglobe.ne.jp', 'x14.peps.jp', 'x59.peps.jp', 'xv-s.heteml.jp', 'yaplog.jp', 'yaraon.blog109.fc2.com', 'yfrog.com', 'yiyine.info', 'z.twipple.jp', 'zasshi.news.yahoo.co.jp', 'zozo.jp', 'z-x.in'
      ].include? domain
  end
  
  def self.extract_domain(url)
    return nil if ! url
    if url =~ /https?:\/\/(([a-zA-Z0-9\-]+\.?)+)/ then
      return $1
    else
      return nil
    end
  end
end